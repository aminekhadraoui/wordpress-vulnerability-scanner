<?php

echo "
  ___  _  _  __  _  _  __  _  _   __   _  _     _    _  ____  ___ 
 / __)( )( )(  )( \( )/ _)( )( ) (  ) ( \( )   ( \/\/ )(_  _)(  _)
 \__ \ )__(  )(  )  (( (_  )__(  /__\  )  (  ___\    /   )(   ) _)
 (___/(_)(_)(__)(_)\_)\__)(_)(_)(_)(_)(_)\_)(___)\/\/   (__) (_)  
      WordPress Vulnerability Scanner - coded by miral

     Thanks to :  benz family
                        All Members benz


";
echo "Input your target (ex:victim.com) : ";
$target = trim(fgets(STDIN));
$totalvuln = "0";
$totalnotvuln = "0";

if(!preg_match("/^http:\/\//",$target) AND !preg_match("/^https:\/\//",$target)){
	$targets = "http://$target";
}else{
	$targets = $target;
}

echo "\n[~] Scanning => $targets";

/* Exploit WordPress Plugin Work The Flow File Upload 2.5.2 - miral - benz */
echo "\n\n[+] Testing Exploit WordPress Plugin Work The Flow File Upload 2.5.2";
$urlwtf = "$targets/wp-content/plugins/work-the-flow-file-upload/public/assets/jQuery-File-Upload-9.5.0/server/php/index.php";
$curlwtf = curl_init();
curl_setopt($curlwtf, CURLOPT_URL, $urlwtf);
curl_setopt($curlwtf, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($curlwtf, CURLOPT_RETURNTRANSFER, 1);
$response = curl_exec($curlwtf);
$httpCode = curl_getinfo($curlwtf, CURLINFO_HTTP_CODE);
curl_close($curlwtf);
if($httpCode == 200){
	echo "\n    > Result : 200 ok";
	echo "\n    > Exploit : WordPress Plugin Work The Flow File Upload 2.5.2";
	$totalvuln = $totalvuln + 1;
}else{
	echo "\n    > Result : 404";
	echo "\n    > Not Vulnerable";
	$totalnotvuln = $totalnotvuln + 1;
}
/* Exploit WordPress Plugin Work The Flow File Upload 2.5.2 - miral - benz */

/* Exploit WordPress mTheme-Unus Local File Inclusion - miral - benz */
echo "\n\n[+] Testing Exploit WordPress mTheme-Unus Local File Inclusion";
$urltu = "$targets/wp-content/themes/mTheme-Unus/css/css.php";
$curltu = curl_init();
curl_setopt($curltu, CURLOPT_URL, $urltu);
curl_setopt($curltu, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($curltu, CURLOPT_RETURNTRANSFER, 1);
$response = curl_exec($curltu);
$httpCode = curl_getinfo($curltu, CURLINFO_HTTP_CODE);
curl_close($curltu);
if($httpCode == 200){
	echo "\n    > Result : 200 ok";
	echo "\n    > Exploit : WordPress mTheme-Unus Local File Inclusion";
	$totalvuln = $totalvuln + 1;
}else{
	echo "\n    > Result : 404";
	echo "\n    > Not Vulnerable";
	$totalnotvuln = $totalnotvuln + 1;
}
/* Exploit WordPress mTheme-Unus Local File Inclusion - miral - benz */

/* Exploit WordPress Job-Manager - miral - benz */
echo "\n\n[+] Testing Exploit WordPress Job-Manager";
$urljm = "$targets/jm-ajax/upload_file";
$curljm = curl_init();
curl_setopt($curljm, CURLOPT_URL, $urljm);
curl_setopt($curljm, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($curljm, CURLOPT_RETURNTRANSFER, 1);
$response = curl_exec($curljm);
$httpCode = curl_getinfo($curljm, CURLINFO_HTTP_CODE);
curl_close($curljm);
if($httpCode == 200){
	echo "\n    > Result : 200 ok";
	echo "\n    > Exploit : WordPress Job-Manager";
	$totalvuln = $totalvuln + 1;
}else{
	echo "\n    > Result : 404";
	echo "\n    > Not Vulnerable";
	$totalnotvuln = $totalnotvuln + 1;
}
/* Exploit WordPress Job-Manager - miral - benz */

/* Exploit WordPress Plugin Gallery 3.06 - Arbitrary File Upload - miral - benz */
echo "\n\n[+] Testing Exploit WordPress Plugin Gallery 3.06 - Arbitrary File Upload";
$urlpg = "$targets/wp-content/plugins/gallery-plugin/upload/php.php";
$curlpg = curl_init();
curl_setopt($curlpg, CURLOPT_URL, $urlpg);
curl_setopt($curlpg, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($curlpg, CURLOPT_RETURNTRANSFER, 1);
$response = curl_exec($curlpg);
$httpCode = curl_getinfo($curlpg, CURLINFO_HTTP_CODE);
curl_close($curlpg);
if($httpCode == 200){
	echo "\n    > Result : 200 ok";
	echo "\n    > Exploit : WordPress Plugin Gallery 3.06 - Arbitrary File Upload";
	$totalvuln = $totalvuln + 1;
}else{
	echo "\n    > Result : 404";
	echo "\n    > Not Vulnerable";
	$totalnotvuln = $totalnotvuln + 1;
}
/* Exploit WordPress Plugin Gallery 3.06 - Arbitrary File Upload - miral - benz */

/* Exploit WordPress Plugin Photo Gallery 1.2.5 - Unrestricted Arbitrary File Upload - miral - benz */
echo "\n\n[+] Testing Exploit WordPress Plugin Photo Gallery 1.2.5 - Unrestricted Arbitrary File Upload";
$urlppg = "$targets/wp-admin/admin-ajax.php?action=bwg_UploadHandler&dir=rce/";
$curlppg = curl_init();
curl_setopt($curlppg, CURLOPT_URL, $urlppg);
curl_setopt($curlppg, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($curlppg, CURLOPT_RETURNTRANSFER, 1);
$response = curl_exec($curlppg);
$httpCode = curl_getinfo($curlppg, CURLINFO_HTTP_CODE);
curl_close($curlppg);
if($httpCode == 200){
	echo "\n    > Result : 200 ok";
	echo "\n    > Exploit : WordPress Plugin Photo Gallery 1.2.5 - Unrestricted Arbitrary File Upload";
	$totalvuln = $totalvuln + 1;
}else{
	echo "\n    > Result : 404";
	echo "\n    > Not Vulnerable";
	$totalnotvuln = $totalnotvuln + 1;
}
/* Exploit WordPress Plugin Photo Gallery 1.2.5 - Unrestricted Arbitrary File Upload - miral - benz */

/* Exploit WordPress 4.7.0/4.7.1 Content Injection - miral - benz */
echo "\n\n[+] Testing Exploit WordPress 4.7.0/4.7.1 Content Injection";
$urlci = "$targets/wp-json/wp/v2/posts";
$curlci = curl_init();
curl_setopt($curlci, CURLOPT_URL, $urlci);
curl_setopt($curlci, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($curlci, CURLOPT_RETURNTRANSFER, 1);
$response = curl_exec($curlci);
$httpCode = curl_getinfo($curlci, CURLINFO_HTTP_CODE);
curl_close($curlci);
if($httpCode == 200){
	echo "\n    > Result : 200 ok";
	echo "\n    > Exploit : WordPress 4.7.0/4.7.1 Content Injection";
	$totalvuln = $totalvuln + 1;
}else{
	echo "\n    > Result : 404";
	echo "\n    > Not Vulnerable";
	$totalnotvuln = $totalnotvuln + 1;
}
/* Exploit WordPress 4.7.0/4.7.1 Content Injection - miral - benz */

/* Exploit WordPress 4.7.0/4.7.1 Username Enumeration - miral - benz */
echo "\n\n[+] Testing Exploit WordPress 4.7.0/4.7.1 Username Enumeration";
$urlue = "$targets/wp-json/wp/v2/users";
$curlue = curl_init();
curl_setopt($curlue, CURLOPT_URL, $urlue);
curl_setopt($curlue, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($curlue, CURLOPT_RETURNTRANSFER, 1);
$response = curl_exec($curlue);
$httpCode = curl_getinfo($curlue, CURLINFO_HTTP_CODE);
curl_close($curlue);
if($httpCode == 200){
	echo "\n    > Result : 200 ok";
	echo "\n    > Exploit : WordPress 4.7.0/4.7.1 Username Enumeration";
	$totalvuln = $totalvuln + 1;
}else{
	echo "\n    > Result : 404";
	echo "\n    > Not Vulnerable";
	$totalnotvuln = $totalnotvuln + 1;
}
/* Exploit WordPress 4.7.0/4.7.1 Username Enumeration - miral - benz */

/* Exploit WordPress Gravity Form Arbitrary File Upload - miral - benz */
echo "\n\n[+] Testing Exploit WordPress Gravity Form Arbitrary File Upload";
$urlgf = "$targets/index.php?gf_page=upload";
$curlgf = curl_init();
curl_setopt($curlgf, CURLOPT_URL, $urlgf);
curl_setopt($curlgf, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($curlgf, CURLOPT_RETURNTRANSFER, 1);
$response = curl_exec($curlgf);
$httpCode = curl_getinfo($curlgf, CURLINFO_HTTP_CODE);
curl_close($curlgf);
if($httpCode == 200){
	echo "\n    > Result : 200 ok";
	echo "\n    > Exploit : WordPress Gravity Form Arbitrary File Upload";
	$totalvuln = $totalvuln + 1;
}else{
	echo "\n    > Result : 404";
	echo "\n    > Not Vulnerable";
	$totalnotvuln = $totalnotvuln + 1;
}
/* Exploit WordPress Gravity Form Arbitrary File Upload - miral - benz */

/* Exploit WordPress Plugin ACF Frontend Display 2.0.5 - miral - benz */
echo "\n\n[+] Testing Exploit WordPress Plugin ACF Frontend Display 2.0.5";
$urlacffd = "$targets/wp-content/plugins/acf-frontend-display/js/blueimp-jQuery-File-Upload-d45deb1/server/php/index.php";
$curlacffd = curl_init();
curl_setopt($curlacffd, CURLOPT_URL, $urlacffd);
curl_setopt($curlacffd, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($curlacffd, CURLOPT_RETURNTRANSFER, 1);
$response = curl_exec($curlacffd);
$httpCode = curl_getinfo($curlacffd, CURLINFO_HTTP_CODE);
curl_close($curlacffd);
if($httpCode == 200){
	echo "\n    > Result : 200 ok";
	echo "\n    > Exploit : WordPress Plugin ACF Frontend Display 2.0.5";
	$totalvuln = $totalvuln + 1;
}else{
	echo "\n    > Result : 404";
	echo "\n    > Not Vulnerable";
	$totalnotvuln = $totalnotvuln + 1;
}
/* Exploit WordPress Plugin ACF Frontend Display 2.0.5 - miral - benz */

/* Exploit Wordpress Infocus3 Theme Arbitrary File Download Vulnerability - miral - benz */
echo "\n\n[+] Testing Exploit Wordpress Infocus3 Theme Arbitrary File Download Vulnerability";
$urlifafd = "$targets/wp-content/themes/infocus3/lib/scripts/dl-skin.php";
$curlifafd = curl_init();
curl_setopt($curlifafd, CURLOPT_URL, $urlifafd);
curl_setopt($curlifafd, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($curlifafd, CURLOPT_RETURNTRANSFER, 1);
$response = curl_exec($curlifafd);
$httpCode = curl_getinfo($curlifafd, CURLINFO_HTTP_CODE);
curl_close($curlifafd);
if($httpCode == 200){
	echo "\n    > Result : 200 ok";
	echo "\n    > Exploit : Wordpress Infocus3 Theme Arbitrary File Download Vulnerability";
	$totalvuln = $totalvuln + 1;
}else{
	echo "\n    > Result : 404";
	echo "\n    > Not Vulnerable";
	$totalnotvuln = $totalnotvuln + 1;
}
/* Exploit Wordpress Infocus3 Theme Arbitrary File Download Vulnerability - miral - benz */

/* Exploit WP Install Vulnerability - miral - benz */
echo "\n\n[+] Testing Exploit WP Install Vulnerability";
$urlwpiv = "$targets/wp-admin/install.php";
$curlwpiv = curl_init();
curl_setopt($curlwpiv, CURLOPT_URL, $urlwpiv);
curl_setopt($curlwpiv, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($curlwpiv, CURLOPT_RETURNTRANSFER, 1);
$response = curl_exec($curlwpiv);
$httpCode = curl_getinfo($curlwpiv, CURLINFO_HTTP_CODE);
curl_close($curlwpiv);
if($httpCode == 200){
	echo "\n    > Result : 200 ok";
	echo "\n    > Exploit : WP Install Vulnerability";
	$totalvuln = $totalvuln + 1;
}else{
	echo "\n    > Result : 404";
	echo "\n    > Not Vulnerable";
	$totalnotvuln = $totalnotvuln + 1;
}
/* Exploit WP Install Vulnerability - miral - benz */

/* Exploit WordPress Product Options For WooCommerce Plugin File Upload - miral - benz */
echo "\n\n[+] Testing Exploit WordPress Product Options For WooCommerce Plugin File Upload";
$urlpofw = "$targets/wp-content/plugins/woocommerce-product-options/includes/image-upload.php";
$curlpofw = curl_init();
curl_setopt($curlpofw, CURLOPT_URL, $urlpofw);
curl_setopt($curlpofw, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($curlpofw, CURLOPT_RETURNTRANSFER, 1);
$response = curl_exec($curlpofw);
$httpCode = curl_getinfo($curlpofw, CURLINFO_HTTP_CODE);
curl_close($curlpofw);
if($httpCode == 200){
	echo "\n    > Result : 200 ok";
	echo "\n    > Exploit : WordPress Product Options For WooCommerce Plugin File Upload";
	$totalvuln = $totalvuln + 1;
}else{
	echo "\n    > Result : 404";
	echo "\n    > Not Vulnerable";
	$totalnotvuln = $totalnotvuln + 1;
}
/* Exploit WordPress Product Options For WooCommerce Plugin File Upload - miral - benz */

echo "\n\n [x] Result :";
echo "\n    [~] Total Vulnerability = $totalvuln";
echo "\n    [~] Total Not Vulnerability = $totalnotvuln\n\n";
?>